# ------------------------------
# STAGE 1: Build base
# ------------------------------
FROM node:18

# Establecer directorio de trabajo
WORKDIR /app

# Copiar solo archivos de dependencias primero (para cache)
COPY package*.json ./

# Instalar dependencias de producciÃ³n por defecto
RUN npm install

# ðŸ‘‡ AsegÃºrate de copiar el script de espera
COPY wait-for-it.sh /wait-for-it.sh
RUN chmod +x /wait-for-it.sh

# Copiar el resto del cÃ³digo fuente
COPY . .

# Exponer el puerto que usarÃ¡ la API
EXPOSE 3000

# ðŸ”§ Comando por defecto para desarrollo
CMD ["npx", "nodemon", "server.js"]
